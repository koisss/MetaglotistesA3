%option noyywrap


%{

#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#include "token.h"

int line = 1;

%}




DELIMITER       [ \t]+
INTCONST        0|[1-9]+[0-9]*
VARIABLE	FILLME




%%

{DELIMITER}     { return DELIMITER; }
{INTCONST}      { return INTCONST; }
{VARIABLE}	{ /* FILL ME */ }
\n              { line++; printf("\n"); }
<<EOF>>		{ printf("#END-OF-FILE#\n"); exit(0); }

%%


char *tname[2] = {"DELIMITER","INTCONST" /*, FILL ME */};



int main(int argc, char **argv){
        int token;


        if(argc == 3){
                if(!(yyin = fopen(argv[1], "r"))) {
                        fprintf(stderr, "Cannot read file: %s\n", argv[1]);
                        return 1;
                }
                if(!(yyout = fopen(argv[2], "w"))) {
                        fprintf(stderr, "Cannot create file: %s\n", argv[2]);
                        return 1;
                }
        }
        else if(argc == 2){
                if(!(yyin = fopen(argv[1], "r"))) {
                        fprintf(stderr, "Cannot read file: %s\n", argv[1]);
                        return 1;
                }
        }


        while( (token=yylex()) >= 0){
                   brethhke kathws kai to onoma tou mazi me thn timh tou. */
                fprintf(yyout, "\tLine=%d, token=%s, value=\"%s\"\n", line, tname[token-1], yytext);
        }
        return 0;
}
